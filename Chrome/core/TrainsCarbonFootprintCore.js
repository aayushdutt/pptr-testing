function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var TrainsFootprintCore=function(){function e(t,a){_classCallCheck(this,e),this.settingsProvider=t,this.helper=a,this.getData=function(e,t){var a=new XMLHttpRequest;a.open("GET",e),a.onreadystatechange=function(e){4==a.readyState&&200==a.status&&t(JSON.parse(a.responseText))},a.send()},distanceBetween=0}return _createClass(e,[{key:"fuzzySearch",value:function(e,t){var a=t.length,n=e.length;if(n>a)return!1;if(n===a)return e===t;e:for(var r=0,o=0;r<n;r++){for(var i=e.charCodeAt(r);o<a;)if(t.charCodeAt(o++)===i)continue e;return!1}return!0}},{key:"storeDataSource",value:function(e){this.getData(this.helper.getFilePath("core/resources/trainEmissions.json"),function(t){trainData=t.trainData[e]})}},{key:"storeTrainSpeed",value:function(e){this.getData(this.helper.getFilePath("core/resources/trains.json"),function(t){trainSpeedData=t[e]})}},{key:"geocode",value:function(e){var t=this;distanceBetween=1,this.getData("https://maps.googleapis.com/maps/api/geocode/json?&address="+e[0],function(a){var n=a.results[0].geometry.location;t.getData("https://maps.googleapis.com/maps/api/geocode/json?&address="+e[1],function(e){var a=e.results[0].geometry.location;distanceBetween=t.getDistance(n.lat,n.lng,a.lat,a.lng)})})}},{key:"convertToTrainDistance",value:function(e){return 1.4089*e-38}},{key:"getDistance",value:function(e,t,a,n){var r=.017453292519943295,o=Math.cos,i=.5-o((a-e)*r)/2+o(e*r)*o(a*r)*(1-o((n-t)*r))/2,s=12742*Math.asin(Math.sqrt(i));return this.convertToTrainDistance(s)}},{key:"getEmission",value:function(e){for(var t=0,a=0,n=e.length;a<n;a++)mode=trainData[e[a]]?trainData[e[a]]:trainData.average,t+=trainData[e[a]]?trainData[e[a]]:trainData.average;t/=e.length;var r=distanceBetween*t;return this.createHTMLElement(r)}},{key:"createHTMLElement",value:function(e){var t=document.createElement("div");return knowMoreUrl=this.helper.getFilePath("pages/knowMore.html"),t.setAttribute("id","carbon-footprint-label"),t.innerHTML="<a href="+knowMoreUrl+" target='_blank' title='footprint' class='carbon' id='carbon'>"+this.footprintToString(e)+'<svg id="quest_mark_icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 92 92"><path d="M45.4 0C20 0.3-0.3 21.2 0 46.6c0.3 25.4 21.2 45.7 46.6 45.4 25.4-0.3 45.7-21.2 45.4-46.6C91.7 20 70.8-0.3 45.4 0zM45.3 74l-0.3 0c-3.9-0.1-6.7-3-6.6-6.9 0.1-3.8 2.9-6.5 6.7-6.5l0.2 0c4 0.1 6.7 3 6.6 6.9C51.9 71.3 49.1 74 45.3 74zM61.7 41.3c-0.9 1.3-2.9 2.9-5.5 4.9l-2.8 1.9c-1.5 1.2-2.5 2.3-2.8 3.4 -0.3 0.9-0.4 1.1-0.4 2.9l0 0.5H39.4l0-0.9c0.1-3.7 0.2-5.9 1.8-7.7 2.4-2.8 7.8-6.3 8-6.4 0.8-0.6 1.4-1.2 1.9-1.9 1.1-1.6 1.6-2.8 1.6-4 0-1.7-0.5-3.2-1.5-4.6 -0.9-1.3-2.7-2-5.3-2 -2.6 0-4.3 0.8-5.4 2.5 -1.1 1.7-1.6 3.5-1.6 5.4v0.5H27.9l0-0.5c0.3-6.8 2.7-11.6 7.2-14.5C37.9 18.9 41.4 18 45.5 18c5.3 0 9.9 1.3 13.4 3.9 3.6 2.6 5.4 6.5 5.4 11.6C64.4 36.3 63.5 38.9 61.7 41.3z" /></svg>',t.querySelector("a").addEventListener("click",function(e){e.stopPropagation()}),t}},{key:"footprintToString",value:function(e){var t=" g";return e>=1e3&&(t=" kg",e/=1e3),""+(e=e.toFixed(1))+t+" CO<sub>2</sub> per person"}}]),e}(),trainData,distanceBetween,trainSpeedData,CarbonFootprintCore=TrainsFootprintCore;